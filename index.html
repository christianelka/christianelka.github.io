<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agen Terang vs Agen Gelap</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        :root {
            --primary: #8b5cf6;
            --secondary: #06b6d4;
            --accent: #f472b6;
            --dark: #0f172a;
            --darker: #020617;
            --card-bg: rgba(30, 41, 59, 0.7);
            --glass: rgba(255, 255, 255, 0.05);
        }

        * {
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: linear-gradient(-45deg, var(--darker), #1e1b4b, #1e293b, var(--dark));
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            color: #e2e8f0;
            overflow-x: hidden;
        }

        @keyframes gradientBG {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        /* ========== LOADING SCREEN ========== */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--darker), #1e1b4b);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-logo {
            font-size: 5rem;
            animation: loadingPulse 1.5s ease-in-out infinite, loadingFloat 3s ease-in-out infinite;
        }

        @keyframes loadingPulse {

            0%,
            100% {
                filter: drop-shadow(0 0 20px rgba(139, 92, 246, 0.6));
            }

            50% {
                filter: drop-shadow(0 0 40px rgba(139, 92, 246, 1));
            }
        }

        @keyframes loadingFloat {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .loading-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 1.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent));
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {

            0%,
            100% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }
        }

        .loading-bar-container {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            margin-top: 2rem;
            overflow: hidden;
        }

        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            background-size: 200% 100%;
            border-radius: 2px;
            width: 0%;
            animation: loadingProgress 2s ease-out forwards, shimmerBar 1s ease infinite;
        }

        @keyframes loadingProgress {
            0% {
                width: 0%;
            }

            50% {
                width: 70%;
            }

            100% {
                width: 100%;
            }
        }

        @keyframes shimmerBar {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }

        .loading-tip {
            margin-top: 1.5rem;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
            animation: fadeInOut 4s ease infinite;
        }

        @keyframes fadeInOut {

            0%,
            100% {
                opacity: 0.3;
            }

            50% {
                opacity: 0.7;
            }
        }

        /* ========== PARTICLE BACKGROUND ========== */
        .particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.8) 0%, transparent 70%);
            border-radius: 50%;
            animation: particleFloat linear infinite;
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 1;
            }

            90% {
                opacity: 1;
            }

            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* ========== ENHANCED SCREEN TRANSITIONS ========== */
        .screen {
            position: relative;
            z-index: 1;
        }

        .screen-enter {
            animation: screenEnter 0.6s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
        }

        .screen-exit {
            animation: screenExit 0.4s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
        }

        @keyframes screenEnter {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }

            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes screenExit {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }

            100% {
                opacity: 0;
                transform: translateY(-20px) scale(0.98);
            }
        }

        /* ========== 3D CARD FLIP ========== */
        .role-card {
            perspective: 1000px;
            transform-style: preserve-3d;
        }

        .role-card-inner {
            position: relative;
            width: 100%;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
        }

        .role-card.flipped .role-card-inner {
            transform: rotateY(180deg);
        }

        .role-card-front,
        .role-card-back {
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        .role-card-back {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            transform: rotateY(180deg);
        }

        .role-card.revealed {
            animation: cardGlow 2s ease-in-out infinite;
        }

        @keyframes cardGlow {

            0%,
            100% {
                box-shadow: 0 0 20px rgba(6, 182, 212, 0.3);
            }

            50% {
                box-shadow: 0 0 40px rgba(6, 182, 212, 0.6);
            }
        }

        /* ========== CONFETTI ========== */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9998;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            animation: confettiFall linear forwards;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* ========== RIPPLE EFFECT ========== */
        .btn-glow,
        .btn-outline-glow {
            position: relative;
            overflow: hidden;
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            transform: scale(0);
            animation: rippleEffect 0.6s linear;
            pointer-events: none;
        }

        @keyframes rippleEffect {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* ========== ANIMATED GRADIENT TEXT ========== */
        .gradient-text-animated {
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent), var(--primary));
            background-size: 300% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientMove 4s ease infinite;
        }

        @keyframes gradientMove {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        /* ========== TIMER PULSE ========== */
        .timer-ring.warning {
            animation: timerPulse 0.5s ease infinite;
        }

        @keyframes timerPulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        .timer-ring.danger .timer-inner {
            color: #ef4444;
            animation: timerShake 0.3s ease infinite;
        }

        @keyframes timerShake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-2px);
            }

            75% {
                transform: translateX(2px);
            }
        }

        /* ========== PLAYER BADGE ENTRANCE ========== */
        .player-badge {
            animation: badgeSlideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes badgeSlideIn {
            0% {
                opacity: 0;
                transform: translateX(-30px) scale(0.8);
            }

            100% {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        .player-badge.removing {
            animation: badgeSlideOut 0.3s ease forwards;
        }

        @keyframes badgeSlideOut {
            0% {
                opacity: 1;
                transform: translateX(0) scale(1);
            }

            100% {
                opacity: 0;
                transform: translateX(30px) scale(0.8);
            }
        }

        /* ========== VOTE BUTTON ANIMATION ========== */
        .vote-btn {
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .vote-btn:hover {
            transform: scale(1.05);
        }

        .vote-btn.selected {
            animation: voteSelected 0.4s ease;
        }

        @keyframes voteSelected {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1.05);
            }
        }

        /* ========== SCORE COUNTER ANIMATION ========== */
        .score-row {
            animation: scoreSlideIn 0.5s ease;
        }

        .score-row:nth-child(1) {
            animation-delay: 0.1s;
        }

        .score-row:nth-child(2) {
            animation-delay: 0.2s;
        }

        .score-row:nth-child(3) {
            animation-delay: 0.3s;
        }

        .score-row:nth-child(4) {
            animation-delay: 0.4s;
        }

        .score-row:nth-child(5) {
            animation-delay: 0.5s;
        }

        @keyframes scoreSlideIn {
            0% {
                opacity: 0;
                transform: translateX(-20px);
            }

            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* ========== MODAL ANIMATION ========== */
        .modal.show .modal-content {
            animation: modalPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes modalPop {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
            }

            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* ========== GLASS CARD HOVER ENHANCED ========== */
        .glass-card {
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.4s ease;
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transition: left 0.5s ease;
            pointer-events: none;
        }

        .glass-card:hover::before {
            left: 100%;
        }

        .screen {
            animation: fadeInScale 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        @keyframes fadeInScale {
            0% {
                opacity: 0;
                transform: scale(0.95);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px -12px rgba(139, 92, 246, 0.2);
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .btn-glow {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border: none;
            border-radius: 1rem;
            padding: 0.875rem 2rem;
            font-weight: 600;
            color: white;
            transition: all 0.3s;
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.4);
        }

        .btn-glow:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 50px rgba(139, 92, 246, 0.6);
            color: white;
        }

        .btn-outline-glow {
            background: transparent;
            border: 2px solid var(--primary);
            border-radius: 1rem;
            padding: 0.875rem 2rem;
            font-weight: 600;
            color: var(--primary);
            transition: all 0.3s;
        }

        .btn-outline-glow:hover {
            background: var(--primary);
            color: white;
        }

        .player-badge {
            background: var(--glass);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .role-card {
            background: linear-gradient(135deg, var(--dark), #1e293b);
            border-radius: 1.5rem;
            padding: 2rem;
            text-align: center;
            border: 2px solid var(--primary);
            cursor: pointer;
            transition: all 0.5s;
        }

        .role-card.revealed {
            border-color: var(--secondary);
        }

        .role-card:hover {
            transform: scale(1.02);
        }

        .timer-ring {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: conic-gradient(var(--primary) var(--progress, 100%), rgba(255, 255, 255, 0.1) 0);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .timer-inner {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--dark);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .vote-btn {
            background: var(--glass);
            border: 2px solid transparent;
            border-radius: 1rem;
            padding: 1rem;
            transition: all 0.3s;
            cursor: pointer;
        }

        .vote-btn:hover,
        .vote-btn.selected {
            border-color: var(--accent);
            background: rgba(244, 114, 182, 0.2);
        }

        .score-row {
            background: var(--glass);
            border-radius: 1rem;
            padding: 1rem;
            margin-bottom: 0.5rem;
        }

        .hidden {
            display: none !important;
        }

        .form-control {
            background: var(--glass);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1rem;
            color: white;
            padding: 0.875rem 1.25rem;
        }

        .form-control:focus {
            background: var(--glass);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
        }

        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .screen {
            min-height: 100vh;
            padding: 1rem;
        }

        @media (min-width: 768px) {
            .screen {
                padding: 2rem;
            }
        }

        .role-box {
            background: var(--glass);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 1rem;
            text-align: center;
        }

        .ayat-badge {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border-radius: 0.75rem;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            display: inline-block;
            margin-top: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .ayat-badge::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%) rotate(45deg);
            }

            100% {
                transform: translateX(100%) rotate(45deg);
            }
        }

        .role-box {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .role-box:hover {
            transform: scale(1.03);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .floating-guide-btn {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--glass);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .floating-guide-btn:hover {
            background: var(--primary);
            color: white;
            transform: rotate(15deg) scale(1.1);
        }

        @media (max-width: 576px) {
            .floating-guide-btn {
                top: 0.5rem;
                right: 0.5rem;
                width: 2.5rem;
                height: 2.5rem;
            }
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        .form-check-input:checked {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .form-check-switch-custom {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .role-preview-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
        }

        @media (max-width: 400px) {
            .role-preview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Responsive Fixes */
        @media (max-width: 576px) {
            .glass-card {
                padding: 1rem !important;
            }

            h2,
            .h2 {
                font-size: 1.25rem !important;
            }

            h3,
            .h3 {
                font-size: 1.15rem !important;
            }

            .btn-glow,
            .btn-outline-glow {
                padding: 0.75rem 1rem;
                font-size: 0.875rem;
            }

            .form-check-switch-custom {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .form-check-switch-custom .form-check-input {
                margin-left: 0;
                align-self: flex-start;
            }

            .role-preview-grid {
                gap: 0.25rem;
            }

            .role-box {
                padding: 0.5rem;
            }

            .role-box i {
                font-size: 1rem !important;
            }

            .role-box small {
                font-size: 0.6rem !important;
            }

            .role-box .h5 {
                font-size: 1rem !important;
            }

            .timer-ring {
                width: 80px;
                height: 80px;
            }

            .timer-inner {
                width: 64px;
                height: 64px;
                font-size: 1.25rem;
            }
        }

        @media (max-width: 400px) {
            .role-preview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Very small screens */
        @media (max-width: 360px) {
            .container {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }

            .glass-card {
                padding: 0.75rem !important;
            }
        }
    </style>
</head>

<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-logo">
            <i class="bi bi-lightbulb-fill" style="color: #8b5cf6;"></i>
        </div>
        <div class="loading-title">Agen Terang vs Agen Gelap</div>
        <div class="loading-bar-container">
            <div class="loading-bar"></div>
        </div>
        <div class="loading-tip">Menyiapkan permainan...</div>
    </div>

    <!-- Particle Background -->
    <div class="particles-container" id="particles-container"></div>

    <!-- Confetti Container -->
    <div class="confetti-container" id="confetti-container"></div>

    <!-- Floating Guide Button -->
    <button class="floating-guide-btn" data-bs-toggle="modal" data-bs-target="#guideModal" title="Panduan Game">
        <i class="bi bi-book"></i>
    </button>

    <!-- Screen: Welcome -->
    <div id="screen-welcome" class="screen d-flex align-items-center justify-content-center">
        <div class="glass-card p-4 p-md-5 text-center" style="max-width: 500px; width: 100%;">
            <div class="mb-4">
                <i class="bi bi-lightbulb-fill gradient-text" style="font-size: 4rem;"></i>
            </div>
            <h1 class="gradient-text fw-bold mb-2" style="font-size: 2rem;">Agen Terang</h1>
            <p class="text-secondary mb-4">vs Agen Gelap</p>
            <p class="small text-secondary mb-4">Permainan Social Deduction bertema Alkitab</p>
            <div class="mb-4">
                <label class="form-label">Jumlah Pemain (min. 4)</label>
                <input type="number" id="playerCount" class="form-control text-center" min="4" value="6">
            </div>
            <p class="small text-secondary mb-4"><i class="bi bi-shuffle me-1"></i>Tingkat kesulitan acak setiap
                permainan</p>
            <button class="btn btn-glow w-100 mb-3" onclick="Game.startSetup()">
                <i class="bi bi-gear-fill me-2"></i>Atur Permainan
            </button>
            <div class="row g-2 mb-3">
                <div class="col-6">
                    <button class="btn btn-outline-glow w-100" onclick="Game.enableSound()" id="btnEnableSound">
                        <i class="bi bi-volume-up me-2"></i>Suara
                    </button>
                </div>
                <div class="col-6">
                    <button class="btn btn-outline-glow w-100" data-bs-toggle="modal" data-bs-target="#guideModal">
                        <i class="bi bi-book me-2"></i>Panduan
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Screen: Role Config -->
    <div id="screen-config" class="screen hidden d-flex align-items-center justify-content-center">
        <div class="glass-card p-4 p-md-5" style="max-width: 500px; width: 100%;">
            <h2 class="gradient-text text-center mb-4">Konfigurasi Peran</h2>
            <p class="text-center text-secondary mb-4">Total <span id="configPlayerCount"
                    class="text-info fw-bold">6</span> pemain</p>

            <div class="row g-3 mb-4">
                <div class="col-6">
                    <label class="form-label"><i class="bi bi-moon-stars-fill text-secondary me-1"></i>Agen
                        Gelap</label>
                    <input type="number" id="darkCount" class="form-control text-center" min="1" value="1"
                        onchange="Game.updateConfigPreview()">
                </div>
                <div class="col-6">
                    <label class="form-label"><i class="bi bi-question-circle-fill text-info me-1"></i>Murid
                        Bingung</label>
                    <input type="number" id="confusedCount" class="form-control text-center" min="0" value="1"
                        onchange="Game.updateConfigPreview()">
                </div>
                <div class="col-6">
                    <label class="form-label"><i class="bi bi-exclamation-triangle-fill text-danger me-1"></i>Nabi
                        Palsu</label>
                    <input type="number" id="falseProphetCount" class="form-control text-center" min="0" value="0"
                        onchange="Game.updateConfigPreview()">
                    <small class="text-secondary">Tahu kata, tapi membingungkan!</small>
                </div>
            </div>

            <!-- Duo Mode Toggle -->
            <div class="role-box mb-4">
                <div class="form-check-switch-custom">
                    <label class="form-check-label" for="duoModeCheck">
                        <i class="bi bi-people-fill me-1"></i>Duo Mode (2+ Agen Gelap saling tahu)
                    </label>
                    <div class="form-check form-switch p-0 m-0">
                        <input class="form-check-input ms-0" type="checkbox" id="duoModeCheck"
                            style="width: 3rem; height: 1.5rem; cursor: pointer;">
                    </div>
                </div>
                <small class="text-secondary d-block mt-1">Jika aktif, semua Agen Gelap akan mengetahui identitas satu
                    sama lain</small>
            </div>

            <div class="role-preview-grid mb-4">
                <div class="role-box">
                    <i class="bi bi-lightbulb-fill text-warning d-block" style="font-size: 1.25rem;"></i>
                    <small class="text-secondary">Terang</small>
                    <div class="h5 mb-0" id="previewLight">4</div>
                </div>
                <div class="role-box">
                    <i class="bi bi-moon-stars-fill text-secondary d-block" style="font-size: 1.25rem;"></i>
                    <small class="text-secondary">Gelap</small>
                    <div class="h5 mb-0" id="previewDark">1</div>
                </div>
                <div class="role-box">
                    <i class="bi bi-question-circle-fill text-info d-block" style="font-size: 1.25rem;"></i>
                    <small class="text-secondary">Bingung</small>
                    <div class="h5 mb-0" id="previewConfused">1</div>
                </div>
                <div class="role-box">
                    <i class="bi bi-exclamation-triangle-fill text-danger d-block" style="font-size: 1.25rem;"></i>
                    <small class="text-secondary">N.Palsu</small>
                    <div class="h5 mb-0" id="previewFalseProphet">0</div>
                </div>
            </div>

            <button class="btn btn-glow w-100" onclick="Game.confirmConfig()">
                <i class="bi bi-people-fill me-2"></i>Daftarkan Pemain
            </button>
        </div>
    </div>

    <!-- Screen: Player Setup -->
    <div id="screen-setup" class="screen hidden">
        <div class="container" style="max-width: 600px;">
            <div class="glass-card p-4">
                <h2 class="gradient-text text-center mb-4">Daftarkan Pemain</h2>
                <div class="input-group mb-3">
                    <input type="text" id="playerNameInput" class="form-control" placeholder="Nama pemain..."
                        maxlength="20">
                    <button class="btn btn-glow" onclick="Game.addPlayer()"><i class="bi bi-plus-lg"></i></button>
                </div>
                <div id="playerList" class="mb-4"></div>
                <p class="text-center text-secondary mb-3">
                    <span id="playerProgress">0</span>/<span id="playerTotal">6</span> pemain terdaftar
                </p>
                <button id="btnStartGame" class="btn btn-glow w-100" onclick="Game.startGame()" disabled>
                    <i class="bi bi-play-fill me-2"></i>Mulai Permainan
                </button>
            </div>
        </div>
    </div>

    <!-- Screen: Role Reveal -->
    <div id="screen-role" class="screen hidden">
        <div class="container text-center" style="max-width: 500px;">
            <div class="glass-card p-4 p-md-5">
                <h3 class="mb-4">Giliran <span id="rolePlayerName" class="gradient-text">Pemain</span></h3>
                <div id="roleCard" class="role-card mb-4" onclick="Game.revealRole()">
                    <div id="roleHidden">
                        <i class="bi bi-question-circle" style="font-size: 5rem; opacity: 0.5;"></i>
                        <p class="mt-3 text-secondary">Tap untuk melihat peranmu</p>
                    </div>
                    <div id="roleRevealed" class="hidden">
                        <div id="roleIcon" style="font-size: 4rem;"></div>
                        <h2 id="roleName" class="mt-3 mb-2"></h2>
                        <p id="roleWord" class="h3 text-info mb-2"></p>
                        <div id="roleAyat" class="ayat-badge hidden"></div>
                        <p id="roleDesc" class="text-secondary small mt-3"></p>
                    </div>
                </div>
                <button id="btnNextRole" class="btn btn-glow w-100 hidden" onclick="Game.nextRole()">
                    Lanjut <i class="bi bi-arrow-right ms-2"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Screen: Discussion (Real-world clues) -->
    <div id="screen-discuss" class="screen hidden">
        <div class="container text-center" style="max-width: 600px;">
            <div class="glass-card p-4">
                <span class="badge bg-secondary mb-3">Ronde <span id="currentRound">1</span></span>
                <div class="timer-ring mx-auto mb-3" id="discussTimer">
                    <div class="timer-inner" id="discussTimerText">600</div>
                </div>
                <h2 class="gradient-text mb-2">Waktu Diskusi & Clue!</h2>
                <p class="text-secondary mb-3">Berikan clue secara lisan sesuai urutan</p>

                <!-- Clue Order -->
                <div class="role-box mb-3">
                    <p class="mb-2 text-secondary small"><i class="bi bi-list-ol me-1"></i>Urutan Memberikan Clue:</p>
                    <div id="clueOrderList" class="text-start small"></div>
                </div>

                <!-- Eliminated Players -->
                <div id="eliminatedBox" class="role-box mb-3 hidden">
                    <p class="mb-1 text-secondary small"><i class="bi bi-x-circle me-1"></i>Tereliminasi:</p>
                    <div id="eliminatedList" class="text-danger small"></div>
                </div>

                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <button class="btn btn-outline-glow w-100" onclick="Game.showModeratorView()">
                            <i class="bi bi-eye me-1"></i>Moderator
                        </button>
                    </div>
                    <div class="col-6">
                        <button class="btn btn-glow w-100" onclick="Game.startVoting()">
                            <i class="bi bi-hand-index-thumb me-1"></i>Voting
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Screen: Voting -->
    <div id="screen-vote" class="screen hidden">
        <div class="container" style="max-width: 600px;">
            <div class="glass-card p-4">
                <h3 class="text-center mb-2">Giliran <span id="votePlayerName" class="gradient-text">Pemain</span></h3>
                <p class="text-center text-secondary mb-4">Pilih pemain yang mencurigakan</p>
                <div id="voteList" class="row g-2 mb-4"></div>
                <button id="btnSubmitVote" class="btn btn-glow w-100" onclick="Game.submitVote()" disabled>Konfirmasi
                    Pilihan</button>
            </div>
        </div>
    </div>

    <!-- Screen: Reveal -->
    <div id="screen-reveal" class="screen hidden">
        <div class="container text-center" style="max-width: 500px;">
            <div class="glass-card p-4 p-md-5">
                <h2 id="revealTitle" class="gradient-text mb-4"></h2>
                <div id="revealIcon" style="font-size: 5rem;" class="mb-3"></div>
                <h3 id="revealPlayer" class="mb-2"></h3>
                <p id="revealRole" class="h5 mb-4"></p>
                <div id="guessSection" class="hidden mb-4">
                    <p class="text-secondary">Kesempatan menebak kata!</p>
                    <div class="input-group">
                        <input type="text" id="guessInput" class="form-control" placeholder="Tebak kata...">
                        <button class="btn btn-glow" onclick="Game.submitGuess()">Tebak</button>
                    </div>
                </div>
                <button id="btnContinue" class="btn btn-glow w-100" onclick="Game.continueGame()">Lanjutkan</button>
            </div>
        </div>
    </div>

    <!-- Screen: Final Score -->
    <div id="screen-final" class="screen hidden">
        <div class="container" style="max-width: 600px;">
            <div class="glass-card p-4 text-center">
                <p class="text-secondary mb-2">Permainan ke-<span id="finalGameNumber">1</span></p>
                <h1 class="gradient-text mb-4">üèÜ Hasil Akhir</h1>
                <div id="winnerAnnounce" class="mb-4"></div>
                <h5 class="text-start mb-3">Papan Skor:</h5>
                <div id="finalScores" class="mb-4"></div>
                <div class="role-box mb-4">
                    <p class="mb-1 text-secondary small">Kata yang dicari</p>
                    <h3 id="finalWord" class="text-info mb-1"></h3>
                    <small class="text-success"><i class="bi bi-book me-1"></i><span id="finalAyat"></span></small>
                </div>
                <div class="row g-2">
                    <div class="col-6">
                        <button class="btn btn-glow w-100" onclick="Game.continueWithSamePlayers()">
                            <i class="bi bi-arrow-right-circle me-2"></i>Lanjut
                        </button>
                    </div>
                    <div class="col-6">
                        <button class="btn btn-outline-glow w-100" onclick="Game.restart()">
                            <i class="bi bi-arrow-repeat me-2"></i>Mulai Ulang
                        </button>
                    </div>
                </div>
                <p class="small text-secondary mt-3 mb-0">Lanjut = pemain tetap, kata baru | Mulai Ulang = dari awal</p>
                <div id="sessionStats" class="text-center mt-2"></div>
            </div>
        </div>
    </div>
    <!-- Game Modal -->
    <div class="modal fade" id="gameModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content"
                style="background: var(--card-bg); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); border-radius: 1.5rem;">
                <div class="modal-body text-center p-4">
                    <div id="modalIcon" style="font-size: 4rem;" class="mb-3"></div>
                    <h4 id="modalTitle" class="gradient-text mb-3"></h4>
                    <p id="modalMessage" class="text-secondary"></p>
                    <button type="button" class="btn btn-glow w-100 mt-3" data-bs-dismiss="modal"
                        id="modalCloseBtn">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Moderator Modal -->
    <div class="modal fade" id="moderatorModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content"
                style="background: var(--card-bg); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); border-radius: 1.5rem;">
                <div class="modal-header border-0">
                    <h5 class="modal-title gradient-text"><i class="bi bi-eye me-2"></i>Mode Moderator</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <div class="role-box mb-3 text-center">
                        <p class="small text-secondary mb-1">Kata Rahasia</p>
                        <h4 id="modWord" class="text-info mb-1"></h4>
                        <p class="small text-secondary mb-1">Kata Bingung</p>
                        <h5 id="modConfusedWord" class="text-warning mb-1"></h5>
                        <small id="modAyat" class="text-success"></small>
                    </div>
                    <p class="small text-secondary mb-2">Daftar Peran:</p>
                    <div id="modRoleList"></div>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-glow w-100" data-bs-dismiss="modal">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Guide Modal -->
    <div class="modal fade" id="guideModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
            <div class="modal-content"
                style="background: var(--card-bg); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); border-radius: 1.5rem;">
                <div class="modal-header border-0">
                    <h5 class="modal-title gradient-text"><i class="bi bi-book me-2"></i>Panduan & Tips Moderator</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <!-- Nav Tabs -->
                    <ul class="nav nav-pills nav-fill mb-4 bg-dark p-1 rounded-pill" id="guideTabs">
                        <li class="nav-item">
                            <a class="nav-link active rounded-pill px-2 py-1 small" data-bs-toggle="tab"
                                href="#howToPlay">Alur</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link rounded-pill px-2 py-1 small" data-bs-toggle="tab"
                                href="#rolesGuide">Peran</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link rounded-pill px-2 py-1 small" data-bs-toggle="tab"
                                href="#tipsGuide">Tips</a>
                        </li>
                    </ul>

                    <div class="tab-content">
                        <!-- How To Play -->
                        <div class="tab-pane fade show active" id="howToPlay">
                            <h6 class="text-info"><i class="bi bi-1-circle me-2"></i>Persiapan</h6>
                            <p class="small text-secondary">Tentukan jumlah pemain dan peran. Moderator memastikan semua
                                pemain siap menyimak.</p>

                            <h6 class="text-info"><i class="bi bi-2-circle me-2"></i>Pembagian Peran</h6>
                            <p class="small text-secondary">Pemain melihat peran masing-masing secara bergantian.
                                Pastikan tidak ada yang mengintip!</p>

                            <h6 class="text-info"><i class="bi bi-3-circle me-2"></i>Diskusi & Clue</h6>
                            <p class="small text-secondary">Setiap pemain menyebutkan 1 kata petunjuk sesuai urutan acak
                                yang muncul di layar.</p>

                            <h6 class="text-info"><i class="bi bi-4-circle me-2"></i>Voting & Eliminasi</h6>
                            <p class="small text-secondary">Setelah diskusi, pilih satu orang yang paling dicurigai
                                sebagai Agen Gelap. Jika tebakan salah, tantangan meningkat!</p>
                        </div>

                        <!-- Roles Guide -->
                        <div class="tab-pane fade" id="rolesGuide">
                            <div class="role-box mb-3 border-warning">
                                <h6 class="text-warning mb-1">üí° Agen Terang</h6>
                                <p class="small text-secondary mb-0">Tahu kata yang benar. Harus memberikan clue yang
                                    jelas buat sesama tim, tapi jangan terlalu terbuka supaya tidak ditebak musuh.</p>
                            </div>
                            <div class="role-box mb-3 border-danger">
                                <h6 class="text-danger mb-1">üåô Agen Gelap</h6>
                                <p class="small text-secondary mb-0">Tidak tahu kata rahasia. Tugasnya pura-pura tahu
                                    dan mengikuti alur clue pemain lain.</p>
                            </div>
                            <div class="role-box mb-3 border-info">
                                <h6 class="text-info mb-1">‚ùì Murid Bingung</h6>
                                <p class="small text-secondary mb-0">Dapat kata yang mirip (misal: "Musa" vs "Harun").
                                    Harus jeli mencari tahu apakah dia di tim Terang atau bukan.</p>
                            </div>
                            <div class="role-box mb-3 border-danger">
                                <h6 class="text-danger mb-1">‚ö†Ô∏è Nabi Palsu</h6>
                                <p class="small text-secondary mb-0">Tahu kata rahasia, tapi misinya menyabotase!
                                    Berikan clue yang "benar" tapi sedikit melenceng untuk membingungkan Agen Terang.
                                </p>
                            </div>
                        </div>

                        <!-- Tips & Tricks -->
                        <div class="tab-pane fade" id="tipsGuide">
                            <ul class="small text-secondary list-unstyled">
                                <li class="mb-2"><i
                                        class="bi bi-check2-circle text-success me-2"></i><strong>Atmosfer</strong>:
                                    Gunakan background music menegangkan untuk menambah keseruan.</li>
                                <li class="mb-2"><i
                                        class="bi bi-check2-circle text-success me-2"></i><strong>Teguran</strong>:
                                    Jangan biarkan diskusi berlarut-larut. Moderator harus tegas soal waktu.</li>
                                <li class="mb-2"><i
                                        class="bi bi-check2-circle text-success me-2"></i><strong>Acting</strong>:
                                    Dorong Agen Gelap untuk berani berargumen dan menyalahkan orang lain.</li>
                                <li class="mb-2"><i
                                        class="bi bi-check2-circle text-success me-2"></i><strong>Kreativitas</strong>:
                                    Clue tidak boleh berupa nama kata itu sendiri. Gunakan sifat, sejarah, atau ayat.
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-glow w-100" data-bs-dismiss="modal">Saya Mengerti!</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="game_logic.js"></script>
    <script>
        // Initialize game animations
        document.addEventListener('DOMContentLoaded', function () {
            Game.init();
        });

        // Prevent accidental page refresh during game
        window.addEventListener('beforeunload', function (e) {
            // Check if game is active (not on welcome screen and has players)
            const isOnWelcome = !document.getElementById('screen-welcome').classList.contains('hidden');
            if (Game.players.length > 0 && !isOnWelcome) {
                e.preventDefault();
                e.returnValue = 'Permainan sedang berlangsung. Yakin ingin meninggalkan halaman?';
                return e.returnValue;
            }
        });
    </script>
</body>

</html>